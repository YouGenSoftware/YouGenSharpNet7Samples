<!-- **** This file and its contents were generated by YouGen Sharp on (UTC) 20230307200636 on behalf of: ****
**** You Gen Software LLC ****
**** 5961 BeaconPark St ****
**** Lithia Florida 33547 United States of America ****
**** whose account is uniquely identified by: 716881407 ****
**** This file and its contents are subject to the conditions of use for the Enterprise Tier License as specified at: https://www.yougensoft.com/en/conditions-of-use. ****
**** This comment block must not be removed. ****
 -->
<h4 Class="my-2">@modelName</h4>
<MudTable T="Northwind_dbo_Employees_IR" @ref="primaryTable" Height="250px"
        RowClassFunc="@SelectedRowClassFunc" OnRowClick="RowClickEvent"
        Items="RetrievedRecords" HorizontalScrollbar="true" Hover="true"
        SortLabel="Sort By" Filter="new Func<Northwind_dbo_Employees_IR,Boolean>(FilterFuncAll)" FixedHeader="true">
    <ToolBarContent>
        <MudTextField @bind-Value="searchFilterText" Placeholder="Filter retrieved records" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0"></MudTextField>
    </ToolBarContent>
			<HeaderContent>
			<MudTh><MudTableSortLabel SortBy="new Func<Northwind_dbo_Employees_IR, object>(x=>x.LastName!)">LastName</MudTableSortLabel></MudTh>
			<MudTh><MudTableSortLabel SortBy="new Func<Northwind_dbo_Employees_IR, object>(x=>x.FirstName!)">FirstName</MudTableSortLabel></MudTh>
			<MudTh><MudTableSortLabel SortBy="new Func<Northwind_dbo_Employees_IR, object>(x=>x.Title!)">Title</MudTableSortLabel></MudTh>
			<MudTh><MudTableSortLabel SortBy="new Func<Northwind_dbo_Employees_IR, object>(x=>x.TitleOfCourtesy!)">TitleOfCourtesy</MudTableSortLabel></MudTh>
			<MudTh><MudTableSortLabel SortBy="new Func<Northwind_dbo_Employees_IR, object>(x=>x.BirthDate!)">BirthDate</MudTableSortLabel></MudTh>
			<MudTh><MudTableSortLabel SortBy="new Func<Northwind_dbo_Employees_IR, object>(x=>x.HireDate!)">HireDate</MudTableSortLabel></MudTh>
			<MudTh><MudTableSortLabel SortBy="new Func<Northwind_dbo_Employees_IR, object>(x=>x.Address!)">Address</MudTableSortLabel></MudTh>
			<MudTh><MudTableSortLabel SortBy="new Func<Northwind_dbo_Employees_IR, object>(x=>x.City!)">City</MudTableSortLabel></MudTh>
			<MudTh><MudTableSortLabel SortBy="new Func<Northwind_dbo_Employees_IR, object>(x=>x.Region!)">Region</MudTableSortLabel></MudTh>
			<MudTh><MudTableSortLabel SortBy="new Func<Northwind_dbo_Employees_IR, object>(x=>x.PostalCode!)">PostalCode</MudTableSortLabel></MudTh>
			<MudTh><MudTableSortLabel SortBy="new Func<Northwind_dbo_Employees_IR, object>(x=>x.Country!)">Country</MudTableSortLabel></MudTh>
			<MudTh><MudTableSortLabel SortBy="new Func<Northwind_dbo_Employees_IR, object>(x=>x.HomePhone!)">HomePhone</MudTableSortLabel></MudTh>
			<MudTh><MudTableSortLabel SortBy="new Func<Northwind_dbo_Employees_IR, object>(x=>x.Extension!)">Extension</MudTableSortLabel></MudTh>
			<MudTh><MudTableSortLabel SortBy="new Func<Northwind_dbo_Employees_IR, object>(x=>x.Photo!)">Photo</MudTableSortLabel></MudTh>
			<MudTh><MudTableSortLabel SortBy="new Func<Northwind_dbo_Employees_IR, object>(x=>x.Notes!)">Notes</MudTableSortLabel></MudTh>
			<MudTh><MudTableSortLabel SortBy="new Func<Northwind_dbo_Employees_IR, object>(x=>x.PhotoPath!)">PhotoPath</MudTableSortLabel></MudTh>
		</HeaderContent>
		<RowTemplate>
			<MudTd DataLabel="LastName">@context.LastName</MudTd>
			<MudTd DataLabel="FirstName">@context.FirstName</MudTd>
			<MudTd DataLabel="Title">@context.Title</MudTd>
			<MudTd DataLabel="TitleOfCourtesy">@context.TitleOfCourtesy</MudTd>
			<MudTd DataLabel="BirthDate">@context.BirthDate</MudTd>
			<MudTd DataLabel="HireDate">@context.HireDate</MudTd>
			<MudTd DataLabel="Address">@context.Address</MudTd>
			<MudTd DataLabel="City">@context.City</MudTd>
			<MudTd DataLabel="Region">@context.Region</MudTd>
			<MudTd DataLabel="PostalCode">@context.PostalCode</MudTd>
			<MudTd DataLabel="Country">@context.Country</MudTd>
			<MudTd DataLabel="HomePhone">@context.HomePhone</MudTd>
			<MudTd DataLabel="Extension">@context.Extension</MudTd>
			<MudTd DataLabel="Photo">@context.Photo</MudTd>
			<MudTd DataLabel="Notes">@context.Notes</MudTd>
			<MudTd DataLabel="PhotoPath">@context.PhotoPath</MudTd>
		</RowTemplate>
</MudTable>
@code {
    [Parameter]
    public IEnumerable<Northwind_dbo_Employees_IR>? RetrievedRecords { get; set; }
    private String? _primaryKey;
    [Parameter]
    public String? PrimaryKey {
        get => _primaryKey;
        set
        {
            if (_primaryKey == value) return;
            _primaryKey = value;
            GetAndSelectMatchingRecord();
        }
    }
    private Northwind_dbo_Employees_IR? selectedItem { get; set; }
    [Parameter]
    public Northwind_dbo_Employees_IR? SelectedItem {
        get => selectedItem;
        set
        {
            if (selectedItem == value) return;
            selectedItem = value;
        }
    }
    [Parameter]
    public EventCallback<Northwind_dbo_Employees_IR?> SelectedItemChanged { get; set; }
	[Inject] Northwind_dbo_Employees_HttpClient? httpClient { get; set; }
	// [Inject] Northwind_dbo_Employees_SignalRWebsocketClient? websocketClient { get; set; }
    private MudTable<Northwind_dbo_Employees_IR>? primaryTable = new MudTable<Northwind_dbo_Employees_IR>();
    private Northwind_dbo_Employees_IR searchModel = new Northwind_dbo_Employees_IR();
    private String searchFilterText = "";
    private String modelName = "Northwind_dbo_Employees_IR";
    private Boolean FilterFuncAll(Northwind_dbo_Employees_IR element) => FilterFunc(element, searchFilterText);
    private Boolean FilterFunc(Northwind_dbo_Employees_IR element, String searchString)
    {
        if (String.IsNullOrWhiteSpace(searchString))
            return true;
        if ($"{ element.EmployeeID_IR } { element.LastName } { element.FirstName } { element.Title } { element.TitleOfCourtesy } { element.BirthDate } { element.HireDate } { element.Address } { element.City } { element.Region } { element.PostalCode } { element.Country } { element.HomePhone } { element.Extension } { element.Photo } { element.Notes } { element.ReportsTo_IR } { element.PhotoPath }".Contains(searchString))
           return true;
        return false;
    }
    private void RowClickEvent(TableRowClickEventArgs<Northwind_dbo_Employees_IR> tableRowClickEventArgs)
	{
	}
    private String SelectedRowClassFunc(Northwind_dbo_Employees_IR element, Int32 rowNumber)
    {
        if (primaryTable!.SelectedItem != null && primaryTable!.SelectedItem.Equals(element))
            return "selected";
        else
            return "";
    }
    private void SelectRowAdhoc(Northwind_dbo_Employees_IR matchedRecord)
    {
        if (primaryTable!.SelectedItem != null &&
            primaryTable.SelectedItem.PrimaryKeyHashedForUniqueObjectComparison != matchedRecord.PrimaryKeyHashedForUniqueObjectComparison)
            primaryTable.SetSelectedItem(primaryTable.Items!.First(x => x.PrimaryKeyHashedForUniqueObjectComparison == matchedRecord.PrimaryKeyHashedForUniqueObjectComparison));
    }  
    private async Task GetAndSelectMatchingRecord()
    {
        var matchedRecords = await httpClient!.GetByBestMatchedQueryPattern(searchModel);
        // var matchedRecords = await websocketlLient!.GetByBestMatchedQueryPattern(searchModel);
        if (matchedRecords!.Any())
            SelectRowAdhoc(matchedRecords!.First());
        StateHasChanged();
    }
    private void ParsePrimaryKeyParameter()
    {
        //parse the primary key into the searchModel properties
		var splitPrimaryKey = PrimaryKey!.Split((Char)27);
		searchModel.EmployeeID_IR = splitPrimaryKey[0];
    }
    protected override async Task OnInitializedAsync()
    {        
        await base.OnInitializedAsync();
    }
    protected override async Task OnParametersSetAsync() 
    {
        if (!String.IsNullOrWhiteSpace(PrimaryKey))
            ParsePrimaryKeyParameter();
        await base.OnParametersSetAsync();
    }
}
